<app-cards-filter
    [projects]="service.projects"
    (filteredProjects)="filterProjects($event)"
></app-cards-filter>

<div class="cards-section flex justify-center flex-wrap" #projectsElement>
    <div
        class="card"
        *ngFor="let project of projects; let i = index"
        [attr.data-index]="i"
    >
        <a [routerLink]="'/' + service.getSlug(project)">
            <div
                [class]="'cards-section__card card__thumbnail m-2 relative text-center ' + 'cardcolor' + i % 6"
                role="img"
                (mouseleave)="expandedCardList = []"
                [title]="project.titulo"
                [aria-label]="project.titulo"
                [style.background-image]="
                    'url(' + service.getYouTubeImageUrl(project) + ')'
                "
                [style.background-position]="project.imagem_posicao || 'center'"
                [style.background-size]="
                    (project.imagem_largura || 'auto')
                    + ' '
                    + ('135%' || project.imagem_altura)
                "
            >
                <div class="backdrop">
                    <div
                        class="card-title-wrapper text-white pt-3.5"
                        [ngClass]="{
                            'card--hide' : expandedCardList.includes(project.id)
                        }"
                    >
                        <div class="card-title font-extrabold text-3xl">
                            {{ project.titulo }}
                        </div>

                        <div class="card-subtitle font-normal text-xl">
                            {{ project.subtitulo }}
                        </div>
                    </div>

                    <div
                        class="card-tags absolute bottom-8 w-full text-center"
                        [ngClass]="{
                            'card-tags--expand' : expandedCardList.includes(project.id)
                        }"
                    >

                        <ng-container
                            *ngFor="let tag of getTagList(project); let idx = index"
                        >
                            <app-project-tag
                                *ngIf="idx < TAGS_AMOUNT || expandedCardList.includes(project.id)"
                                [tag]="tag"
                                [canCloseOnClick]="true"
                            ></app-project-tag>
                        </ng-container>

                        <button
                            (click)="expandTag($event, project.id)"
                            class="text-sm text-white p-1 m-0.5 w-7 rounded-md border-solid border border-white"
                            *ngIf="!expandedCardList.includes(project.id)"
                        >
                            {{ project.tags.length - 3 }}+
                        </button>
                    </div>
                </div>
            </div>
        </a>
    </div>
</div>
